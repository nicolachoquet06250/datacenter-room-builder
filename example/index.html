<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Builder de Salle de datacenters</title>
    <link rel="stylesheet" href="dist/room-builder.webcomponent.css"/>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        .custom-notify {
            margin-right: 40px;
        }
    </style>
</head>
<body>
<script type="module" src="dist/room-builder.webcomponent.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        const roomBuilder = document.createElement('room-builder');
        roomBuilder.setAttribute('layers', JSON.stringify([
            {
                "id": 1,
                "name": "FloorPlanBuilder:Layers:Walls:Title",
                "racks": [],
                "pods": [],
                "walls": [
                    {
                        "x": 380,
                        "y": 120
                    },
                    {
                        "x": 380,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 120
                    }
                ],
                "footprints": [],
                "circuits": [],
                "pillars": [
                    {
                        "x": 600,
                        "y": 170
                    },
                    {
                        "x": 600,
                        "y": 190
                    },
                    {
                        "x": 620,
                        "y": 190
                    },
                    {
                        "x": 620,
                        "y": 170
                    },
                    {
                        "x": 750,
                        "y": 170
                    },
                    {
                        "x": 750,
                        "y": 190
                    },
                    {
                        "x": 770,
                        "y": 190
                    },
                    {
                        "x": 770,
                        "y": 170
                    },
                    {
                        "x": 880,
                        "y": 170
                    },
                    {
                        "x": 880,
                        "y": 190
                    },
                    {
                        "x": 900,
                        "y": 190
                    },
                    {
                        "x": 900,
                        "y": 170
                    },
                    {
                        "x": 1030,
                        "y": 170
                    },
                    {
                        "x": 1030,
                        "y": 190
                    },
                    {
                        "x": 1050,
                        "y": 190
                    },
                    {
                        "x": 1050,
                        "y": 170
                    }
                ]
            },
            {
                "id": 2,
                "name": "FloorPlanBuilder:Layers:Circuits:Title",
                "racks": [],
                "pods": [],
                "walls": [
                    {
                        "x": 380,
                        "y": 120
                    },
                    {
                        "x": 380,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 120
                    }
                ],
                "footprints": [],
                "circuits": [
                    {
                        "id": 1,
                        "x": null,
                        "y": null,
                        "name": "Circuit 1"
                    },
                    {
                        "id": 2,
                        "x": 500,
                        "y": 260,
                        "name": "Circuit 2"
                    }
                ],
                "pillars": []
            },
            {
                "id": 3,
                "name": "FloorPlanBuilder:Layers:Footprints:Title",
                "racks": [],
                "pods": [],
                "walls": [
                    {
                        "x": 380,
                        "y": 120
                    },
                    {
                        "x": 380,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 120
                    }
                ],
                "footprints": [
                    {
                        "id": "ARwCD3LbXCi7wQ4MK3EBg",
                        "width": 6000,
                        "height": 2000,
                        "units": null,
                        "color": "#BA68C8",
                        "name": "Footprint 1"
                    }
                ],
                "circuits": [],
                "pillars": []
            },
            {
                "id": 4,
                "name": "FloorPlanBuilder:Layers:Racks:Title",
                "racks": [
                    {
                        "id": 1,
                        "roomId": 1,
                        "name": "Rack 1",
                        "x": null,
                        "y": null,
                        "rotation": null,
                        "podId": "pod-1769443744398"
                    },
                    {
                        "roomId": 1,
                        "name": "Rack 2",
                        "x": 600,
                        "y": 360,
                        "rotation": -90,
                        "podId": "pod-1769443744398"
                    }
                ],
                "pods": [
                    {
                        "id": "pod-1769443744398",
                        "name": "Pod 1"
                    }
                ],
                "walls": [
                    {
                        "x": 380,
                        "y": 120
                    },
                    {
                        "x": 380,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 460
                    },
                    {
                        "x": 820,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 360
                    },
                    {
                        "x": 1060,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 660
                    },
                    {
                        "x": 1240,
                        "y": 120
                    }
                ],
                "footprints": [],
                "circuits": [],
                "pillars": []
            }
        ]))
        roomBuilder.setAttribute('room-id', '1')
        roomBuilder.setAttribute('room-name', 'Salle principale')
        
        // Exemple d'utilisation du formulaire iTop
        // roomBuilder.setAttribute('use-itop-form', 'true')
        // roomBuilder.setAttribute('itop-rack-url', 'https://itop.localhost:8009/pages/UI.php?route=linkset.create_linked_object')

        // @ts-ignore
        document.body.appendChild(roomBuilder);

        document.querySelector('room-builder')?.addEventListener(
            'saved',
            /**
             * @param {CustomEvent<[{layers: Layer[]}]>} event
             */
            event => {
                console.log('Room saved:', event.detail[0])
            }
        )
    })
</script>
</body>
</html>
